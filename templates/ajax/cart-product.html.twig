<div class="form popup-form" id="order">
    <h3>Товар добавлен в корзину</h3>
    <div class="wrapper" id="wrapper_vue">
        <div class="row">
            <div class="col-lg-6">
                <img src="{{ product.getWebPath('image') | thumb(318,238) }}" alt="{{ product.menutitle }}">
            </div>
            <div class="col-lg-6">
                <div class="name">{{ product.menutitle }}</div>
                {% set price = product | getPrice(app.request) %}
                {% if price %}
                    <div class="price">Цена:  <b>{{ price | number_format(0, ',', ' ')}}</b> ₽</div>
                {% else %}
                    <div class="price">Цена:  <b>Договорная</b></div>
                {% endif %}
                <div class="number">
                    <span class="minus" v-on:click="minus(true)">-</span>
                    <input type="text"
                           v-model="quantity"
                           digitonly="true"/>
                    <span class="plus" v-on:click="plus(true)">+</span>
                </div>
                <div class="price-sum">
                    <small>Сумма:</small> <% numberFormat(price * quantity) %> <span>₽</span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <p><a href="{{ sitePath(cartPage.route) }}">товаров в корзине: <% quantity + otherCount %></a></p>
                <div class="sum">на сумму <b><% numberFormat(price * quantity + otherAmount) %></b></div>
                <button class="btn btn-red btn-send btn-blue" onclick="window.closePopup();">Продолжить покупки</button>
                <a href="{{ sitePath(cartPage.route) }}" class="btn btn-red btn-send">Оформить заказ</a>
            </div>
        </div>
    </div>
    <script>
        var cartVue = new Vue({
            delimiters: ['<%', '%>'],
            el: '#wrapper_vue',
            data: {
                id: {{ product.id }},
                quantity: {{ product.cartCount }},
                price: {{ price }},
                otherCount: {{ quantity }},
                otherAmount: {{ amount }},
            },
            methods: {
                numberFormat: function (number) {
                    return (new Intl.NumberFormat().format(number)).toString();
                },
                plus: function (send) {
                    this.quantity++;
                    if (send) {
                        window.cart.add(this.id, 1);
                    }
                },
                minus: function (send) {
                    if (this.quantity > 1) {
                        this.quantity--;
                        if (send) {
                            window.cart.add(this.id, -1);
                        }
                    }
                },
                addingItem: function () {
                    window.cart.addingItem(this.id, this.quantity);
                }
            }
        });
    </script>
</div>
